"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{8497:function(e,t,r){let l;r.d(t,{Z:function(){return z}});var n=r(7437),a=r(2265);let s=e=>{let t;let r=new Set,l=(e,l)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=l?l:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,a={setState:l,getState:n,getInitialState:()=>s,subscribe:e=>(r.add(e),()=>r.delete(e))},s=t=e(l,n,a);return a},i=e=>e?s(e):s,d=e=>e,o=[65,70,75,80,85,90,95,100,105,110,115,120],c=e=>5===e?5:10===e||13===e?10:0,u=()=>{let e=[];for(let t of["Red","Yellow","Black","Green"])for(let r=5;r<=14;r++)e.push({suit:t,number:r,points:c(r)});return e},m=e=>{let t=[...e];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t},h=e=>{let t=m(e);return{hands:{A1:t.slice(0,9),B1:t.slice(9,18),A2:t.slice(18,27),B2:t.slice(27,36)},widow:t.slice(36,40)}},x=e=>e.reduce((e,t)=>e+t.points,0),p=(e,t,r)=>!t||!r.some(e=>e.suit===t)||e.suit===t,b=(e,t,r)=>{let l=r?Object.entries(e).filter(e=>{let[t,l]=e;return l.suit===r}):[];if(l.length>0){let[e]=l.reduce((e,t)=>t[1].number>e[1].number?t:e);return e}let n=Object.entries(e).filter(e=>{let[r,l]=e;return l.suit===t});if(n.length>0){let[e]=n.reduce((e,t)=>t[1].number>e[1].number?t:e);return e}let[a]=Object.entries(e).find(e=>{let[t,r]=e;return null!==r})||[""];return a},g=e=>{let t=["A1","B1","A2","B2"],r=t.indexOf(e);return t[(r+1)%4]};var f={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let v=new Uint8Array(16),y=[];for(let e=0;e<256;++e)y.push((e+256).toString(16).slice(1));var j=function(e,t,r){if(f.randomUUID&&!t&&!e)return f.randomUUID();let n=(e=e||{}).random??e.rng?.()??function(){if(!l){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");l=crypto.getRandomValues.bind(crypto)}return l(v)}();if(n.length<16)throw Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return(y[e[t+0]]+y[e[t+1]]+y[e[t+2]]+y[e[t+3]]+"-"+y[e[t+4]]+y[e[t+5]]+"-"+y[e[t+6]]+y[e[t+7]]+"-"+y[e[t+8]]+y[e[t+9]]+"-"+y[e[t+10]]+y[e[t+11]]+y[e[t+12]]+y[e[t+13]]+y[e[t+14]]+y[e[t+15]]).toLowerCase()}(n)};let w=e=>{let t=["A1","B1","A2","B2"],r=t[Math.floor(Math.random()*t.length)];return{id:j(),status:"waiting",phase:"setup",players:{A1:{...e,seat:"A1"},B1:null,A2:null,B2:null},tricks:{A:0,B:0},scores:{A:0,B:0},created:new Date,dealer:r}},N=e=>({id:j(),name:({A1:"Bot A1",B1:"Lefty",A2:"Partner",B2:"Righty"})[e],type:"bot",seat:e,ready:!0}),B=(e=>{let t=i(e),r=e=>(function(e,t=d){let r=a.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return a.useDebugValue(r),r})(t,e);return Object.assign(r,t),r})(e=>({game:null,createGame:t=>{e({game:w(t)})},addBot:t=>{e(e=>e.game?{game:{...e.game,players:{...e.game.players,[t]:N(t)}}}:e)},setPlayerReady:t=>{e(e=>{if(!e.game)return e;let r=e.game.players[t];if(!r)return e;let l={...e.game.players,[t]:{...r,ready:!0}};return Object.values(l).every(e=>e&&e.ready)&&"waiting"===e.game.status?{game:{...e.game,status:"active",phase:"dealing",players:l,currentTurn:e.game.dealer}}:{game:{...e.game,players:l}}})},startNewHand:()=>{e(e=>{if(!e.game)return e;let{hands:t,widow:r}=h(u());return{game:{...e.game,phase:"bidding",players:Object.entries(e.game.players).reduce((e,r)=>{let[l,n]=r;return{...e,[l]:n?{...n,hand:t[l],bid:void 0}:null}},{A1:null,B1:null,A2:null,B2:null}),currentTurn:g(e.game.dealer),widow:r,currentBid:void 0,bidWinner:void 0,trump:void 0,trickCards:{A1:null,B1:null,A2:null,B2:null},trickWinner:void 0,trickComplete:!1,playOrder:[],tricks:{A:0,B:0}}}})},startNextHandWithNewDealer:()=>{e(e=>{if(!e.game)return e;let t=g(e.game.dealer);return{game:{...e.game,phase:"dealing",dealer:t,currentTurn:t,bidWinner:void 0,currentBid:void 0,trump:void 0,widow:void 0,goDown:void 0,trickCards:{A1:null,B1:null,A2:null,B2:null},trickWinner:void 0,trickComplete:!1,playOrder:[],tricks:{A:0,B:0},players:Object.entries(e.game.players).reduce((e,t)=>{let[r,l]=t;return{...e,[r]:l?{...l,hand:void 0,bid:void 0}:null}},{A1:null,B1:null,A2:null,B2:null})}}})},placeBid:(t,r)=>{e(e=>{if(!e.game||"bidding"!==e.game.phase)return e;let l={...e.game.players,[t]:e.game.players[t]?{...e.game.players[t],bid:r}:null},n=Object.values(l).filter(e=>(null==e?void 0:e.bid)==="pass").length,a="pass"===r?e.game.currentBid:r,s=g(t);if(3===n){let t=Object.entries(l).find(e=>{let[t,r]=e;return r&&"pass"!==r.bid});if(t){var i;let r=t[0],n=l[r],a={...n,hand:[...n.hand||[],...e.game.widow||[]]};return{game:{...e.game,players:{...l,[r]:a},phase:"widow",bidWinner:r,currentBid:null===(i=t[1])||void 0===i?void 0:i.bid,currentTurn:r}}}}return{game:{...e.game,players:l,currentBid:a,currentTurn:s}}})},selectGoDown:t=>{e(e=>{if(!e.game||"widow"!==e.game.phase||!e.game.bidWinner)return e;let r=e.game.players[e.game.bidWinner];if(!r||!r.hand)return e;let l=r.hand.filter(e=>!t.some(t=>t.suit===e.suit&&t.number===e.number));return{game:{...e.game,phase:"trump",players:{...e.game.players,[e.game.bidWinner]:{...r,hand:l}},goDown:t}}})},selectTrump:t=>{e(e=>e.game&&"trump"===e.game.phase?{game:{...e.game,phase:"playing",trump:t,currentTurn:g(e.game.dealer),trickCards:{A1:null,B1:null,A2:null,B2:null}}}:e)},playCard:(t,r)=>{e(e=>{var l,n,a,s;if(!e.game||"playing"!==e.game.phase)return e;let i=e.game.players[t];if(!(null==i?void 0:i.hand))return e;if(e.game.currentTurn!==t)return console.log("Not your turn"),e;if((null===(l=e.game.trickCards)||void 0===l?void 0:l[t])!==null)return console.log("Already played a card in this trick"),e;let d=null===(n=e.game.playOrder)||void 0===n?void 0:n[0],o=d?null===(a=e.game.trickCards)||void 0===a?void 0:a[d]:null;if(!p(r,(null==o?void 0:o.suit)||null,i.hand))return console.log("Cannot play this card"),e;if(!i.hand.some(e=>e.suit===r.suit&&e.number===r.number))return console.log("Card not in hand"),e;let c=i.hand.filter(e=>!(e.suit===r.suit&&e.number===r.number)),m={...e.game.trickCards||{A1:null,B1:null,A2:null,B2:null},[t]:r},f=[...e.game.playOrder||[],t];if(Object.values(m).every(e=>null!==e)){let r=null===(s=e.game.playOrder)||void 0===s?void 0:s[0],l=r?m[r]:null;if(!l)return e;let n=b(m,l.suit,e.game.trump||null);Object.values(m).reduce((e,t)=>e+((null==t?void 0:t.points)||0),0);let a={...e.game.tricks,[n.charAt(0)]:e.game.tricks[n.charAt(0)]+1};if(Object.values(e.game.players).every(e=>{var t;return(null==e?void 0:null===(t=e.hand)||void 0===t?void 0:t.length)===0})){let r=x(e.game.goDown||[]),l=e.game.bidWinner.charAt(0),s=e.game.currentBid,d={A:0,B:0};Object.entries(m).forEach(e=>{let[t,r]=e;r&&(d[t.charAt(0)]+=r.points)}),d[n.charAt(0)]+=r,a.A>=5&&(d.A+=20),a.B>=5&&(d.B+=20);let o=d[l],p={...e.game.scores,[l]:e.game.scores[l]+(o>=s?o:-s)};if(p.A>=500||p.B>=500||p.A<=-250||p.B<=-250)return{game:{...e.game,status:"completed",players:{...e.game.players,[t]:{...i,hand:c}},scores:p}};let b=g(e.game.dealer),{hands:f,widow:v}=h(u());return{game:{...e.game,phase:"dealing",players:Object.entries(e.game.players).reduce((e,t)=>{let[r,l]=t;return{...e,[r]:l?{...l,hand:f[r],bid:void 0}:null}},{A1:null,B1:null,A2:null,B2:null}),dealer:b,currentTurn:b,bidWinner:void 0,currentBid:void 0,trump:void 0,widow:void 0,goDown:void 0,trickCards:{A1:null,B1:null,A2:null,B2:null},trickWinner:void 0,trickComplete:!1,playOrder:[],tricks:{A:0,B:0},scores:p}}}return{game:{...e.game,players:{...e.game.players,[t]:{...i,hand:c}},currentTurn:n,trickCards:m,trickWinner:n,trickComplete:!0,playOrder:f,tricks:a}}}return{game:{...e.game,players:{...e.game.players,[t]:{...i,hand:c}},currentTurn:g(t),trickCards:m,trickComplete:!1,playOrder:f}}})},clearTrick:t=>{e(e=>e.game&&"playing"===e.game.phase?{game:{...e.game,currentTurn:t,trickCards:{A1:null,B1:null,A2:null,B2:null},trickWinner:void 0,trickComplete:!1,playOrder:[]}}:e)},resetGame:()=>{e({game:null})},updatePlayerHand:(t,r)=>{e(e=>{if(!e.game)return e;let l=e.game.players[t];return l?{game:{...e.game,players:{...e.game.players,[t]:{...l,hand:r}}}}:e})}})),A=(e,t,r)=>{let l;if(3===r)return t||o[0];let n=x(e),a=e.reduce((e,t)=>(e[t.suit]=(e[t.suit]||0)+1,e),{});return(l=0+2*n+5*e.filter(e=>e.number>=10).length+8*Math.max(...Object.values(a))+(Math.floor(21*Math.random())-10),.5>Math.random()&&r<3||t&&t>.8*l&&r<3)?"pass":t?l>t+10&&o.find(e=>e>t)||"pass":l>=90?90:l>=80?80:l>=70?70:65},k=e=>{let t=e.reduce((e,t)=>(e[t.suit]=(e[t.suit]||0)+1,e),{}),r="Red",l=0;return Object.entries(t).forEach(e=>{let[t,n]=e;n>l&&(l=n,r=t)}),r},T=(e,t,r,l)=>{if(!e||0===e.length)throw Error("Bot has no cards to play");let n=e.filter(r=>!t||!e.some(e=>e.suit===t)||r.suit===t);if(0===n.length)return console.error("No valid cards found - this should not happen. Returning first card as fallback."),e[0];if(!t){let e=n.filter(e=>e.points>0);if(e.length>0)return e.reduce((e,t)=>t.number>e.number?t:e,e[0]);let t=r?n.filter(e=>e.suit!==r):n;return t.length>0?t.reduce((e,t)=>t.number<e.number?t:e,t[0]):n.reduce((e,t)=>t.number<e.number?t:e,n[0])}let a=n.filter(e=>e.suit===t);if(a.length>0){let e=a.filter(e=>e.points>0);return e.length>0?e.reduce((e,t)=>t.number>e.number?t:e,e[0]):a.reduce((e,t)=>t.number<e.number?t:e,a[0])}if(r){let e=n.filter(e=>e.suit===r);if(e.length>0){if(l.some(e=>e.suit===r)){let t=Math.max(...l.filter(e=>e.suit===r).map(e=>e.number)),n=e.filter(e=>e.number>t);if(n.length>0)return n.reduce((e,t)=>t.number<e.number?t:e,n[0])}return e.reduce((e,t)=>t.number<e.number?t:e,e[0])}}return n.reduce((e,t)=>t.points<e.points||t.points===e.points&&t.number<e.number?t:e,n[0])},S={Red:"text-red-600 bg-white hover:bg-red-50",Yellow:"text-yellow-600 bg-white hover:bg-yellow-50",Black:"text-gray-900 bg-white hover:bg-gray-50",Green:"text-green-600 bg-white hover:bg-green-50"},C={Red:"text-white bg-red-600 hover:bg-red-700",Yellow:"text-white bg-yellow-600 hover:bg-yellow-700",Black:"text-white bg-gray-900 hover:bg-gray-950",Green:"text-white bg-green-600 hover:bg-green-700"},O={Red:"bg-red-600",Yellow:"bg-yellow-500",Black:"bg-gray-900",Green:"bg-green-600"};function D(e){let{card:t,onClick:r,disabled:l,selected:a,selectable:s,faceDown:i,highlight:d,dimmed:o}=e,{suit:c,number:u,points:m}=t,{game:h}=B(),x=(null==h?void 0:h.trump)===c,p=x?C[c]:S[c];return i||"Black"===c&&0===u?(0,n.jsxs)("button",{disabled:!0,className:"\n                    relative w-16 h-24 rounded-lg border-2 border-navy-900\n                    bg-navy-800 text-white shadow-lg\n                    transition-all duration-200\n                    flex items-center justify-center\n                ",children:[(0,n.jsx)("div",{className:"absolute inset-1 border-2 border-navy-700 rounded-md opacity-80"}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("span",{className:"material-symbols-outlined text-4xl",children:"raven"})})]}):(0,n.jsxs)("button",{onClick:r,disabled:l,className:"\n                relative w-16 h-24 rounded-lg border-2 shadow-lg\n                ".concat(a?"border-blue-500 transform -translate-y-4":d?"border-white/60":s?"border-gray-300 hover:border-blue-300 hover:-translate-y-2":"border-gray-300","\n                ").concat(l?"cursor-not-allowed":s?"cursor-pointer":"","\n                ").concat(p,"\n                ").concat(o?"opacity-60 grayscale-[30%]":"","\n                transition-all duration-200\n            "),children:[d&&(0,n.jsx)("div",{className:"absolute inset-[-2px] rounded-lg bg-white/10 shadow-[0_0_12px_3px_rgba(255,255,255,0.4)] pointer-events-none"}),(0,n.jsx)("div",{className:"absolute top-1 left-1 font-bold",children:u}),(0,n.jsx)("div",{className:"absolute bottom-1 right-1 rotate-180 font-bold",children:u}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"\n                    w-10 h-10 rounded-full \n                    ".concat(x?"bg-white":O[c],"\n                    flex items-center justify-center\n                    ").concat(x?"shadow-[0_0_12px_rgba(255,255,255,0.2)]":"","\n                    transition-all duration-200\n                "),children:m>0&&(0,n.jsx)("span",{className:"\n                            font-bold text-lg\n                            ".concat(x?"text-".concat(c.toLowerCase(),"-600"):"text-white","\n                        "),children:m})})}),a&&(0,n.jsx)("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-20 rounded-lg flex items-center justify-center",children:(0,n.jsx)("div",{className:"bg-blue-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold",children:"âœ“"})}),s&&!a&&(0,n.jsx)("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-0 hover:bg-opacity-10 rounded-lg flex items-center justify-center",children:(0,n.jsx)("div",{className:"bg-blue-500 bg-opacity-0 hover:bg-opacity-100 text-transparent hover:text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold transition-all duration-200",children:"+"})})]})}let W=e=>{let t=["A1","B1","A2","B2"],r=t.indexOf(e);return t[(r+1)%4]};function _(e){var t;let{lastTrick:r,winner:l,players:a,tricks:s,handScores:i,playOrder:d}=e,o=x(Object.values(r).filter(e=>null!==e)),c=d[0],u=[];if(c){let e=c;for(let t=0;t<4;t++)u.push(e),e=W(e)}return(0,n.jsx)("div",{className:"fixed top-4 right-4 bg-green-900 p-6 rounded-xl shadow-2xl border border-green-700",children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h3",{className:"text-xl font-orbitron font-bold text-white",children:"Last Trick"})}),(0,n.jsx)("div",{className:"flex justify-center gap-3 py-2",children:u.map((e,t)=>{var s,i;return(0,n.jsxs)("div",{className:"\n                                flex flex-col items-center\n                                ".concat(l===e?"relative":"","\n                            "),children:[(0,n.jsx)("div",{className:"\n                                text-xs font-medium mb-1 px-2 py-0.5 rounded-md w-12 text-center\n                                ".concat(0===t?"bg-yellow-600 text-yellow-100":"bg-gray-700 text-gray-200","\n                            "),children:0===t?"Lead":"".concat(t+1)}),(0,n.jsx)("div",{className:"\n                                text-sm font-bold mb-2 px-3 py-1 rounded-lg whitespace-nowrap\n                                ".concat(l===e?"bg-green-600 text-white font-orbitron":"bg-gray-700/80 text-white font-orbitron","\n                            "),children:(null===(s=a[e])||void 0===s?void 0:s.name)?null===(i=a[e])||void 0===i?void 0:i.name.split(" ")[0]:"-"}),(0,n.jsx)("div",{className:"transform scale-[0.85] origin-top",children:r[e]?(0,n.jsx)(D,{card:r[e],disabled:!0,highlight:l===e}):(0,n.jsx)("div",{className:"w-16 h-24 border-2 border-dashed border-white/20 rounded-lg"})})]},e)})}),l&&(0,n.jsx)("div",{className:"bg-green-600 rounded-lg py-2 px-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsx)("span",{className:"material-symbols-outlined text-yellow-300",children:"stars"}),(0,n.jsxs)("span",{className:"font-orbitron font-bold text-white",children:[(null===(t=a[l])||void 0===t?void 0:t.name)?a[l].name.split(" ")[0]:""," won ",o," points!"]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[(0,n.jsxs)("div",{className:"bg-blue-800 rounded-lg p-3 border border-blue-700",children:[(0,n.jsx)("div",{className:"text-sm font-orbitron text-blue-200 mb-1",children:"Team A"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-white",children:i.A}),(0,n.jsx)("div",{className:"text-blue-200 text-sm",children:"pts"}),(0,n.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,n.jsx)("span",{className:"material-symbols-outlined text-yellow-400",children:"raven"}),(0,n.jsxs)("span",{className:"text-yellow-400 font-orbitron font-bold",children:["\xd7",s.A]})]})]})]}),(0,n.jsxs)("div",{className:"bg-red-800 rounded-lg p-3 border border-red-700",children:[(0,n.jsx)("div",{className:"text-sm font-orbitron text-red-200 mb-1",children:"Team B"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-white",children:i.B}),(0,n.jsx)("div",{className:"text-red-200 text-sm",children:"pts"}),(0,n.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,n.jsx)("span",{className:"material-symbols-outlined text-yellow-400",children:"raven"}),(0,n.jsxs)("span",{className:"text-yellow-400 font-orbitron font-bold",children:["\xd7",s.B]})]})]})]})]})]})})}function E(e){var t,r;let{isOpen:l,onClose:a,tricks:s,goDown:i,players:d,bidWinner:o,currentBid:c}=e,{game:u}=B();if(!l)return null;let m=s.reduce((e,t)=>{let r=t.winner.charAt(0),l=x(Object.values(t.cards));return e[r]+=l,e},{A:0,B:0});if(s.length>0){let e=s[s.length-1].winner.charAt(0);m[e]+=x(i)}let h=s.reduce((e,t)=>{let r=t.winner.charAt(0);return e[r]++,e},{A:0,B:0});h.A>=5&&(m.A+=20),h.B>=5&&(m.B+=20);let p=o.charAt(0),b=m[p],g=b>=c?b:-c;return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-green-900 p-4 rounded-xl shadow-2xl border border-green-700 w-[500px] max-h-[90vh] overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{className:"text-2xl font-orbitron font-bold text-white",children:"Hand Recap"}),(0,n.jsx)("button",{onClick:()=>{a()},className:"text-white/80 hover:text-white",children:(0,n.jsx)("span",{className:"material-symbols-outlined",children:"close"})})]}),(0,n.jsxs)("div",{className:"space-y-6 pr-4 max-h-[calc(90vh-8rem)] overflow-y-auto    [&::-webkit-scrollbar]:w-2   [&::-webkit-scrollbar-track]:rounded-full   [&::-webkit-scrollbar-track]:bg-green-950/30   [&::-webkit-scrollbar-thumb]:rounded-full   [&::-webkit-scrollbar-thumb]:bg-white/20   hover:[&::-webkit-scrollbar-thumb]:bg-white/30   [scrollbar-gutter:stable]",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"text-2xl font-orbitron font-bold\n                                ".concat(g>=0?"text-green-400":"text-red-400","\n                            "),children:["Team ",p," ",g>=0?"made it!":"got set!"]}),(0,n.jsxs)("div",{className:"text-white/90 text-base mt-1",children:[null===(t=d[o])||void 0===t?void 0:t.name," took it for ",c," and Team ",p," captured ",b," points"]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{className:"bg-blue-900/30 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-blue-200 font-orbitron text-sm",children:"Team A Points"}),(0,n.jsx)("div",{className:"text-xl font-bold text-white",children:m.A}),(0,n.jsxs)("div",{className:"text-blue-200/80 text-sm",children:[h.A," tricks ",h.A>=5?"(+20 bonus)":""]})]}),(0,n.jsxs)("div",{className:"bg-red-900/30 p-3 rounded-lg",children:[(0,n.jsx)("div",{className:"text-red-200 font-orbitron text-sm",children:"Team B Points"}),(0,n.jsx)("div",{className:"text-xl font-bold text-white",children:m.B}),(0,n.jsxs)("div",{className:"text-red-200/80 text-sm",children:[h.B," tricks ",h.B>=5?"(+20 bonus)":""]})]})]}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsxs)("table",{className:"w-full text-white",children:[(0,n.jsx)("thead",{className:"text-sm font-orbitron bg-green-950/50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Hand"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Winner"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Bid"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Team A"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Team B"})]})}),(0,n.jsxs)("tbody",{className:"divide-y divide-green-800/30 text-sm",children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-3 py-2",children:"1"}),(0,n.jsx)("td",{className:"px-3 py-2",children:null===(r=d[o])||void 0===r?void 0:r.name}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:c}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:"A"===p?g:m.A}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:"B"===p?g:m.B})]}),(0,n.jsxs)("tr",{className:"bg-green-950/50 font-bold text-base",children:[(0,n.jsx)("td",{colSpan:3,className:"px-3 py-2",children:"TOTALS:"}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:"A"===p?g:m.A}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:"B"===p?g:m.B})]})]})]})})]}),(0,n.jsx)("div",{className:"border-t border-green-800"}),(0,n.jsxs)("div",{className:"space-y-3",children:[s.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-none w-10 flex justify-end items-center",children:(0,n.jsx)("div",{className:"font-orbitron font-bold text-white/80 text-[42px]",children:t+1})}),(0,n.jsx)("div",{className:"flex flex-1 justify-center gap-3",children:e.playOrder.map(t=>{var r;return(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"\n                                                text-xs mb-1 px-2 py-0.5 rounded text-center\n                                                ".concat(t===e.winner?"bg-yellow-500/20 text-yellow-200 font-medium shadow-[0_0_8px_rgba(234,179,8,0.2)]":"text-white/80","\n                                            "),children:(null===(r=d[t])||void 0===r?void 0:r.name)?d[t].name.split(" ")[0]:""}),(0,n.jsxs)("div",{className:"\n                                                transform scale-[0.85] origin-top\n                                                ".concat(t===e.winner?"relative":"","\n                                            "),children:[(0,n.jsx)(D,{card:e.cards[t],disabled:!0,highlight:t===e.winner}),t===e.winner&&(0,n.jsx)("div",{className:"absolute inset-0 rounded-lg bg-yellow-400/5 shadow-[0_0_12px_4px_rgba(234,179,8,0.3)] pointer-events-none"})]})]},t)})})]},t)),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-none w-10 flex justify-end items-center",children:(0,n.jsx)("div",{className:"font-orbitron font-bold text-white/80 text-sm",children:"GD"})}),(0,n.jsx)("div",{className:"flex flex-1 justify-center gap-3",children:i.map((e,t)=>(0,n.jsx)("div",{className:"transform scale-[0.85] origin-top",children:(0,n.jsx)(D,{card:e,disabled:!0})},t))})]})]})]})]})})}function R(e){let{isOpen:t,onClose:r,game:l,handScores:a}=e;return t?(0,n.jsxs)("div",{className:"fixed inset-y-0 left-0 w-[600px] bg-green-900/95 backdrop-blur-sm shadow-2xl  transform transition-transform duration-300 ease-in-out z-50 border-r border-green-700",style:{transform:t?"translateX(0)":"translateX(-100%)"},children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-green-700",children:[(0,n.jsx)("h2",{className:"text-2xl font-orbitron font-bold text-white",children:"Score Card"}),(0,n.jsx)("button",{onClick:r,className:"text-white/80 hover:text-white",children:(0,n.jsx)("span",{className:"material-symbols-outlined",children:"close"})})]}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-white",children:[(0,n.jsx)("thead",{className:"text-sm font-orbitron bg-green-950/50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Hand"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Dealer"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Bid Winner"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Winning Bid"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Team A"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Team B"})]})}),(0,n.jsxs)("tbody",{className:"divide-y divide-green-800/30",children:[a.map((e,t)=>{var r,a;return(0,n.jsxs)("tr",{className:"text-sm",children:[(0,n.jsx)("td",{className:"px-3 py-2",children:t+1}),(0,n.jsx)("td",{className:"px-3 py-2",children:null===(r=l.players[e.dealer])||void 0===r?void 0:r.name}),(0,n.jsx)("td",{className:"px-3 py-2",children:null===(a=l.players[e.bidWinner])||void 0===a?void 0:a.name}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:e.bid}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:(0,n.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,n.jsxs)("span",{children:[e.teamAScore>=0?"+":"",e.teamAScore]}),(0,n.jsxs)("span",{className:"text-xs text-white/60",children:["(",e.teamATotal,")"]})]})}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:(0,n.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,n.jsxs)("span",{children:[e.teamBScore>=0?"+":"",e.teamBScore]}),(0,n.jsxs)("span",{className:"text-xs text-white/60",children:["(",e.teamBTotal,")"]})]})})]},t)}),(0,n.jsxs)("tr",{className:"bg-green-950/50 font-bold",children:[(0,n.jsx)("td",{colSpan:4,className:"px-3 py-2",children:"TOTALS:"}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:a.length>0?a[a.length-1].teamATotal:0}),(0,n.jsx)("td",{className:"px-3 py-2 text-right",children:a.length>0?a[a.length-1].teamBTotal:0})]})]})]})})})]}):null}let I={A1:"absolute bottom-[30px] left-1/2 -translate-x-1/2",B1:"absolute left-[-20px] top-1/2 -translate-y-1/2 -rotate-90",A2:"absolute top-[30px] left-1/2 -translate-x-1/2",B2:"absolute right-[-30px] top-1/2 -translate-y-1/2 rotate-90"},U={A1:"absolute -right-[1px] top-50 -translate-y-1/2",B1:"absolute -bottom-[-50px] left-50 -translate-x-1/2 -rotate-90",A2:"absolute -left-[25px] top-5 -translate-y-1/2",B2:"absolute -bottom-[-50px] left-50 -translate-x-1/2 rotate-90"},G={A1:"absolute bottom-[40px] left-1/2 -translate-x-1/2",B1:"absolute left-[40px] top-1/2 -translate-y-1/2",A2:"absolute top-[40px] left-1/2 -translate-x-1/2",B2:"absolute right-[40px] top-1/2 -translate-y-1/2"},L={A1:"absolute bottom-[20px] left-1/2 -translate-x-1/2",B1:"absolute left-[20px] top-1/2 -translate-y-1/2",A2:"absolute top-[20px] left-1/2 -translate-x-1/2",B2:"absolute right-[20px] top-1/2 -translate-y-1/2"};function M(){var e;let{game:t,placeBid:r,selectGoDown:l,selectTrump:s,playCard:i,clearTrick:d,updatePlayerHand:c,startNextHandWithNewDealer:u,startNewHand:m}=B(),h=(0,a.useMemo)(()=>{var e;if(!t)return null;let r=t.currentTurn?t.players[t.currentTurn]:null,l=(null==r?void 0:r.type)==="human",n=!!t.dealer&&(null===(e=t.players[t.dealer])||void 0===e?void 0:e.type)==="human",a="dealing"===t.phase&&t.currentTurn===t.dealer&&n,s="bidding"===t.phase&&l&&null!==r;return{currentPlayer:r,isHumanTurn:l,isHumanDealer:n,canShowDealButton:a,canShowBiddingUI:s,phase:t.phase,currentTurn:t.currentTurn,dealer:t.dealer}},[t]);if(!t||!h)return null;let p=t.currentTurn?t.players[t.currentTurn]:null,b=(null==p?void 0:p.type)==="human";t.dealer&&(null===(e=t.players[t.dealer])||void 0===e||e.type);let[g,f]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),[j,w]=(0,a.useState)([]),[N,S]=(0,a.useState)([]),[C,O]=(0,a.useState)(null),[W,M]=(0,a.useState)([]),[P,z]=(0,a.useState)(null),[H,V]=(0,a.useState)(null),[Y,F]=(0,a.useState)(!1),[K,q]=(0,a.useState)(!1),[X,Z]=(0,a.useState)(!1),[$,J]=(0,a.useState)(!1),[Q,ee]=(0,a.useState)(new Set),[et,er]=(0,a.useState)([]),[el,en]=(0,a.useState)(!1),[ea,es]=(0,a.useState)(!1),[ei]=(0,a.useState)("A1"),[ed,eo]=(0,a.useState)(null),ec=t&&t.currentTurn&&p&&"bot"===p.type&&!t.trickComplete,eu=(e,r)=>{var l,n;let a=x(Object.values(e)),s=r.charAt(0),i={A:((null==C?void 0:null===(l=C.handScores)||void 0===l?void 0:l.A)||0)+("A"===s?a:0),B:((null==C?void 0:null===(n=C.handScores)||void 0===n?void 0:n.B)||0)+("B"===s?a:0)},o=[...N,{cards:e,playOrder:(null==t?void 0:t.playOrder)||[],winner:r,handScores:i}];S(o),O({cards:e,winner:r,handScores:i,playOrder:(null==t?void 0:t.playOrder)||[]}),F(!0),9===o.length&&Z(!0),d(r)},em=async()=>{if(!t||"dealing"!==t.phase||t.currentTurn!==t.dealer||!t.players[t.dealer])return;J(!0),ee(new Set),er([]),V(null),O({cards:{A1:{suit:"Black",number:0,points:0},B1:{suit:"Black",number:0,points:0},A2:{suit:"Black",number:0,points:0},B2:{suit:"Black",number:0,points:0}},winner:"A1",handScores:{A:0,B:0},playOrder:["A1","B1","A2","B2"]}),S([]),Z(!1),en(!1);let e=["A1","B1","A2","B2"],r=e.indexOf(t.dealer);for(let t of[...e.slice((r+1)%4),...e.slice(0,(r+1)%4)])await new Promise(e=>setTimeout(e,200)),ee(e=>new Set([...Array.from(e),t]));await new Promise(e=>setTimeout(e,300)),m(),J(!1)};(0,a.useEffect)(()=>{if(!ec)return;let e=setTimeout(async()=>{if(t&&t.currentTurn&&p&&"bot"===p.type&&!t.trickComplete){if(Object.values(t.players).every(e=>!(null==e?void 0:e.hand)||0===e.hand.length)&&"playing"===t.phase){Z(!0);return}switch(t.phase){case"dealing":t.currentTurn===t.dealer&&await em();break;case"bidding":{if(!p.hand)return;let e=Object.values(t.players).filter(e=>(null==e?void 0:e.bid)==="pass").length,l=A(p.hand,t.currentBid,e);r(t.currentTurn,l);break}case"widow":if(!p.hand)return;l([...p.hand].sort((e,t)=>e.points===t.points?e.number-t.number:e.points-t.points).slice(0,4));break;case"trump":if(!p.hand)return;s(k(p.hand));break;case"playing":{var e;let r;if(!p.hand||0===p.hand.length)return;let l=t.trickCards||{A1:null,B1:null,A2:null,B2:null},n=null===(e=t.playOrder)||void 0===e?void 0:e[0],a=n?l[n]:null,s=(null==a?void 0:a.suit)||null,d=Object.values(l).filter(e=>null!==e),o=[...p.hand];for(;o.length>0;)try{r=T(o,s,t.trump||null,d),i(t.currentTurn,r);break}catch(e){console.log("Failed to play card, trying another one"),o=o.filter(e=>!(e.suit===r.suit&&e.number===r.number))}}}}},1e3);return()=>clearTimeout(e)},[null==t?void 0:t.currentTurn,null==t?void 0:t.phase,null==t?void 0:t.trickCards]);let eh=t&&X&&t.bidWinner&&t.currentBid&&t.dealer;(0,a.useEffect)(()=>{if(!eh)return;let e=t.dealer,r=t.bidWinner,l=t.currentBid,n=N.reduce((e,t)=>{let r=t.winner.charAt(0),l=x(Object.values(t.cards));return e[r]+=l,e},{A:0,B:0});if(N.length>0){let e=N[N.length-1].winner.charAt(0);n[e]+=x(t.goDown||[])}let a=N.reduce((e,t)=>{let r=t.winner.charAt(0);return e[r]++,e},{A:0,B:0});a.A>=5&&(n.A+=20),a.B>=5&&(n.B+=20);let s=r.charAt(0),i=n[s],d=i>=l?i:-l;M(t=>{if(t.some(t=>t.dealer===e&&t.bidWinner===r&&t.bid===l))return t;let a="A"===s?d:n.A,i="B"===s?d:n.B,o=t.length>0?{A:t[t.length-1].teamATotal,B:t[t.length-1].teamBTotal}:{A:0,B:0};return[...t,{dealer:e,bidWinner:r,bid:l,teamAScore:a,teamBScore:i,teamATotal:o.A+a,teamBTotal:o.B+i}]})},[X,null==t?void 0:t.bidWinner,null==t?void 0:t.currentBid,null==t?void 0:t.dealer,null==t?void 0:t.goDown,N]);let ex=N&&N.length>0;(0,a.useEffect)(()=>{if(!ex)return;let e=N[N.length-1];e&&O({cards:e.cards||{A1:null,B1:null,A2:null,B2:null},winner:e.winner||null,handScores:e.handScores||{A:0,B:0},playOrder:e.playOrder||[]})},[X,null==t?void 0:t.bidWinner,null==t?void 0:t.currentBid,null==t?void 0:t.dealer,null==t?void 0:t.goDown,N]);let ep=(null==t?void 0:t.trickComplete)&&t.trickWinner&&t.trickCards;(0,a.useEffect)(()=>{if(!ep)return;let e=t.trickCards,r=setTimeout(()=>{eu(e,t.trickWinner)},3e3);return()=>clearTimeout(r)},[null==t?void 0:t.trickComplete,null==t?void 0:t.trickWinner,null==t?void 0:t.trickCards]);let eb=e=>{et.some(t=>t.suit===e.suit&&t.number===e.number)?er(et.filter(t=>!(t.suit===e.suit&&t.number===e.number))):et.length<4&&er([...et,e])},eg=(e,r)=>{t&&i(e,r)},ef=(e,t)=>{V({index:e,card:t})},ev=(e,r)=>{var l;if(!H||!(null==t?void 0:null===(l=t.players[r])||void 0===l?void 0:l.hand))return;let n=[...t.players[r].hand],a=H.index;n.splice(a,1),n.splice(e,0,H.card),c(r,n),V(null)},ey=(e,r)=>{let l=(null==t?void 0:t.trickComplete)&&(null==t?void 0:t.trickWinner)===e;return(0,n.jsx)("div",{className:"\n                    absolute ".concat({A1:"absolute bottom-[34%] left-[46.8%]",B1:"absolute left-[36%] top-[45%]",A2:"absolute top-[34%] left-[46.8%]",B2:"absolute right-[36%] top-[45%]"}[e],"\n                    ").concat("B1"===e?"-rotate-90":"A2"===e?"rotate-180":"B2"===e?"rotate-90":"","\n                    transition-all duration-300\n                    z-20 scale-[0.8]\n                "),children:(0,n.jsx)(D,{card:r,highlight:l})},"".concat(e,"-").concat(r.suit,"-").concat(r.number))},ej=e=>{var r;let l=null==t?void 0:t.players[e];if(!(null==l?void 0:l.hand)||!t||"dealing"===t.phase&&!Q.has(e))return null;let a=e===(null==t?void 0:t.currentTurn),s="human"===l.type,i=(null==t?void 0:t.phase)==="widow"&&a&&b,d=(null==t?void 0:t.trickCards)||{A1:null,B1:null,A2:null,B2:null},o=null==t?void 0:null===(r=t.playOrder)||void 0===r?void 0:r[0],c=o?d[o]:null,u=(null==c?void 0:c.suit)||null,m=d[e];return(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)("div",{className:"flex gap-2 p-4 relative justify-center",children:l.hand.map((r,d)=>{var o;let c=m&&m.suit===r.suit&&m.number===r.number,h=!u||r.suit===u||!(null===(o=l.hand)||void 0===o?void 0:o.some(e=>e.suit===u));return(0,n.jsx)("div",{className:"\n                                    transition-all duration-200\n                                    ".concat(c?"opacity-0":"opacity-100","\n                                    ").concat(s?"cursor-grab active:cursor-grabbing":"","\n                                    ").concat((null==H?void 0:H.card)===r?"opacity-50":"","\n                                    relative\n                                "),draggable:s,onDragStart:e=>{ef(d,r)},onDragOver:e=>{var t;e.preventDefault(),e.dataTransfer.dropEffect="move";let r=null===(t=e.currentTarget.parentElement)||void 0===t?void 0:t.children;r&&Array.from(r).forEach(e=>{e.classList.remove("border-blue-400")}),e.currentTarget.classList.add("border-blue-400")},onDragLeave:e=>{e.currentTarget.classList.remove("border-blue-400")},onDragEnd:e=>{var t;let r=null===(t=e.currentTarget.parentElement)||void 0===t?void 0:t.children;r&&Array.from(r).forEach(e=>{e.classList.remove("border-blue-400")}),V(null)},onDrop:t=>{t.preventDefault(),t.currentTarget.classList.remove("border-blue-400"),ev(d,e)},children:(0,n.jsx)(D,{card:s?r:{suit:"Black",number:0,points:0},onClick:i?()=>eb(r):a&&b&&(null==t?void 0:t.phase)==="playing"&&h?()=>eg(e,r):void 0,disabled:!a||!b||(null==t?void 0:t.phase)!=="playing"&&(null==t?void 0:t.phase)!=="widow"||(null==t?void 0:t.phase)==="playing"&&!h,selected:i&&et.some(e=>e.suit===r.suit&&e.number===r.number),selectable:i&&et.length<4,dimmed:a&&(null==t?void 0:t.phase)==="playing"&&!h})},"".concat(r.suit,"-").concat(r.number))})})})},ew=()=>{if(!h.canShowBiddingUI)return null;console.log("Rendering bidding UI:",{phase:h.phase,currentTurn:h.currentTurn,isHumanTurn:h.isHumanTurn,canShow:h.canShowBiddingUI});let e=t.currentBid?t.currentBid+5:65;return(0,n.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 bg-white p-4 rounded-lg shadow-lg",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>r(t.currentTurn,"pass"),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Pass"}),o.filter(t=>t>=e).map(e=>(0,n.jsx)("button",{onClick:()=>r(t.currentTurn,e),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:e},e))]})})},eN=()=>"trump"===t.phase&&b?(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg pointer-events-auto",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select Trump Suit"}),(0,n.jsx)("div",{className:"flex gap-2",children:["Red","Yellow","Black","Green"].map(e=>(0,n.jsx)("button",{onClick:()=>s(e),className:"px-4 py-2 rounded text-white\n                                    ".concat("Red"===e?"bg-red-600 hover:bg-red-700":"Yellow"===e?"bg-yellow-600 hover:bg-yellow-700":"Black"===e?"bg-gray-800 hover:bg-gray-900":"bg-green-600 hover:bg-green-700"),children:e},e))})]})}):null,eB=()=>{(null==t?void 0:t.goDown)&&(en(!0),setTimeout(()=>en(!1),2e3))};return(0,n.jsxs)("div",{className:"h-screen w-screen overflow-hidden bg-green-800",children:[(0,n.jsxs)("div",{className:"fixed top-0 left-0 p-8 space-y-4 z-40",children:[(0,n.jsx)("div",{onClick:()=>{var e,r;if(!(null==t?void 0:null===(r=t.players)||void 0===r?void 0:null===(e=r.A1)||void 0===e?void 0:e.hand))return;let l=t.players.A1.hand.reduce((e,t)=>(e[t.suit]||(e[t.suit]=[]),e[t.suit].push(t),e),{});Object.values(l).forEach(e=>{e.sort((e,t)=>t.number-e.number)}),c("A1",Object.entries(l).sort((e,t)=>{let[,r]=e,[,l]=t;return l.length-r.length}).flatMap(e=>{let[,t]=e;return t}))},className:"font-orbitron text-[48px] font-bold text-white cursor-pointer hover:text-white/90 transition-colors",children:"ROOK"}),(0,n.jsxs)("div",{onClick:()=>es(!0),className:"text-white cursor-pointer hover:text-white/90 transition-colors font-orbitron",children:[(0,n.jsx)("div",{className:"text-2xl",children:"Score:"}),(0,n.jsxs)("div",{className:"text-xl",children:["Team A: ",W.length>0?W[W.length-1].teamATotal:0]}),(0,n.jsxs)("div",{className:"text-xl",children:["Team B: ",W.length>0?W[W.length-1].teamBTotal:0]})]})]}),(0,n.jsx)(R,{isOpen:ea,onClose:()=>es(!1),game:t,handScores:W}),X&&t.goDown&&(0,n.jsx)(E,{isOpen:X,onClose:()=>{console.log("Starting next hand..."),Z(!1),F(!1),u(),S([]),O({cards:{A1:{suit:"Black",number:0,points:0},B1:{suit:"Black",number:0,points:0},A2:{suit:"Black",number:0,points:0},B2:{suit:"Black",number:0,points:0}},winner:"A1",handScores:{A:0,B:0},playOrder:["A1","B1","A2","B2"]})},tricks:N,goDown:t.goDown,players:t.players,bidWinner:t.bidWinner,currentBid:t.currentBid}),C&&Y&&(0,n.jsx)(_,{lastTrick:C.cards,winner:C.winner,players:t.players,tricks:t.tricks,handScores:C.handScores||{A:0,B:0},playOrder:C.playOrder}),(0,n.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,n.jsxs)("div",{className:"relative w-full max-w-[1000px] aspect-square flex items-center justify-center mx-auto",children:[(0,n.jsxs)("div",{className:"absolute w-[50%] aspect-square rounded-full bg-green-900 z-0",children:[(0,n.jsx)("div",{className:"absolute top-[-60px] left-1/2 -translate-x-1/2",children:(0,n.jsx)("div",{className:"\n                                w-0 h-0\n                                border-l-[60px] border-l-transparent\n                                border-r-[60px] border-r-transparent\n                                border-b-[90px] border-b-green-900\n                                filter drop-shadow-[0_0_15px_rgba(20,83,45,0.5)]\n                                transition-opacity duration-300\n                                ".concat("A2"===t.currentTurn?"opacity-100":"opacity-0","\n                            ")})}),(0,n.jsx)("div",{className:"absolute right-[-75px] top-1/2 -translate-y-1/2",children:(0,n.jsx)("div",{className:"\n                                w-0 h-0\n                                border-l-[60px] border-l-transparent\n                                border-r-[60px] border-r-transparent\n                                border-b-[90px] border-b-green-900\n                                filter drop-shadow-[0_0_15px_rgba(20,83,45,0.5)]\n                                transition-opacity duration-300\n                                rotate-90\n                                ".concat("B2"===t.currentTurn?"opacity-100":"opacity-0","\n                            ")})}),(0,n.jsx)("div",{className:"absolute bottom-[-60px] left-1/2 -translate-x-1/2",children:(0,n.jsx)("div",{className:"\n                                w-0 h-0S\n                                border-l-[60px] border-l-transparent\n                                border-r-[60px] border-r-transparent\n                                border-b-[90px] border-b-green-900\n                                filter drop-shadow-[0_0_15px_rgba(20,83,45,0.5)]\n                                transition-opacity duration-300\n                                rotate-180\n                                ".concat("A1"===t.currentTurn?"opacity-100":"opacity-0","\n                            ")})}),(0,n.jsx)("div",{className:"absolute left-[-75px] top-1/2 -translate-y-1/2",children:(0,n.jsx)("div",{className:"\n                                w-0 h-0\n                                border-l-[60px] border-l-transparent\n                                border-r-[60px] border-r-transparent\n                                border-b-[90px] border-b-green-900\n                                filter drop-shadow-[0_0_15px_rgba(20,83,45,0.5)]\n                                transition-opacity duration-300\n                                -rotate-90\n                                ".concat("B1"===t.currentTurn?"opacity-100":"opacity-0","\n                            ")})}),Object.entries(t.players).map(e=>{let[r,l]=e;if(!(null==l?void 0:l.bid)||"pass"===l.bid&&"bidding"!==t.phase)return null;let a=t.bidWinner?L[r]:G[r];return(0,n.jsx)("div",{className:"".concat(a),children:"pass"===l.bid?(0,n.jsx)("div",{className:"px-3 py-1 bg-gray-700/90 backdrop-blur-sm border-2 border-gray-600 rounded-lg",children:(0,n.jsx)("div",{className:"font-orbitron font-bold text-gray-300 text-sm",children:"PASS"})}):(0,n.jsx)("div",{className:"\n                                            flex items-center justify-center\n                                            w-12 h-12 rounded-full\n                                            ".concat(t.bidWinner===r?"bg-blue-600 text-white border-2 border-blue-400":"bg-gray-700 text-gray-200 border-2 border-gray-600","\n                                            font-orbitron font-bold text-lg\n                                        "),children:l.bid})},r)})]}),Object.entries(t.players).map(e=>{let[r,l]=e;return l&&(0,n.jsx)("div",{className:"".concat(I[r]),children:(0,n.jsxs)("div",{className:"\n                                    relative\n                                    text-[48px] font-orbitron font-bold text-green-900\n                                    px-4 py-2 rounded-xl\n                                ",children:[l.name.split(" ")[0],t.dealer===r&&(0,n.jsx)("div",{className:"".concat(U[r]),children:(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-yellow-500/90 border-4 border-yellow-400/50 shadow-lg",children:(0,n.jsx)("span",{className:"material-symbols-outlined text-green-900",children:"playing_cards"})})})]})},r)}),(0,n.jsx)("div",{className:"absolute top-[80px] left-1/2 -translate-x-1/2",children:(0,n.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,n.jsx)("div",{className:"flex gap-1 scale-[0.8]",children:ej("A2")})})}),(0,n.jsx)("div",{className:"absolute left-[45px] top-1/2 -translate-y-1/2 w-[20%]",children:(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"transform -rotate-90 origin-center flex gap-1 scale-[0.8]",children:ej("B1")})})}),(0,n.jsx)("div",{className:"absolute right-[45px] top-1/2 -translate-y-1/2 w-[20%]",children:(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"transform rotate-90 origin-center flex gap-1 scale-[0.8]",children:ej("B2")})})}),(0,n.jsx)("div",{className:"absolute bottom-[80px] left-1/2 -translate-x-1/2",children:(0,n.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,n.jsx)("div",{className:"flex gap-1 scale-[0.8]",children:ej("A1")})})}),t.trickCards&&Object.entries(t.trickCards).map(e=>{let[t,r]=e;return r&&ey(t,r)}),(()=>{var e;if(!(null==t?void 0:t.goDown))return null;let r=t.bidWinner&&(null===(e=t.players[t.bidWinner])||void 0===e?void 0:e.type)==="human";return(0,n.jsx)("div",{className:"fixed bottom-8 right-8 z-30",onClick:()=>r&&eB(),children:(0,n.jsxs)("div",{className:"\n                    flex flex-col items-end gap-2 \n                    ".concat(r?"cursor-pointer":"","\n                "),children:[(0,n.jsx)("div",{className:"text-white/80 font-orbitron text-sm px-2",children:"Go Down Cards"}),(0,n.jsx)("div",{className:"flex gap-1",children:t.goDown.map((e,t)=>(0,n.jsx)("div",{className:"\n                                    transform scale-[0.85] origin-top-right\n                                    transition-all duration-300\n                                    ".concat(r?"hover:-translate-y-2":"","\n                                "),children:(0,n.jsx)(D,{card:el?e:{suit:"Black",number:0,points:0},disabled:!0,selectable:r})},t))})]})})})(),"dealing"===t.phase&&t.currentTurn===t.dealer&&(0,n.jsx)("button",{onClick:em,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-50    bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg   shadow-lg transform transition-all duration-200 hover:scale-105 animate-bounce",children:"Deal Cards"})]})}),h.canShowDealButton?(console.log("Rendering deal button:",{phase:h.phase,currentTurn:h.currentTurn,dealer:h.dealer,canShow:h.canShowDealButton}),(0,n.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50",children:(0,n.jsxs)("button",{onClick:em,className:"px-8 py-4 bg-green-600 text-white rounded-xl font-orbitron    shadow-lg transition-colors flex items-center gap-3 text-xl   hover:bg-green-700",children:[(0,n.jsx)("span",{className:"material-symbols-outlined text-3xl",children:"style"}),"Deal Cards"]})})):null,ew(),(()=>{switch(t.phase){case"bidding":return ew();case"widow":if(h.isHumanTurn)return(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg pointer-events-auto",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select 4 Cards for Go-Down"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Selected: ",et.length,"/4 cards"]}),(0,n.jsx)("button",{onClick:()=>{4===et.length&&(l(et),er([]))},disabled:4!==et.length,className:"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Confirm Selection"})]})});return null;case"trump":return eN();default:return null}})()]})}var P=r(666);function z(){let{game:e,createGame:t,addBot:r,setPlayerReady:l}=B(),{user:s,loading:i,signInWithGoogle:d}=(0,P.a)();return((0,a.useEffect)(()=>{s&&!e&&(t({id:s.uid,name:s.displayName||"Player",type:"human",ready:!1}),["B1","A2","B2"].forEach(e=>r(e)),l("A1"))},[s,e,t,r,l]),(null==e?void 0:e.status)==="active")?(0,n.jsx)(M,{}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,n.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-center mb-6",children:"Rook13"}),i?(0,n.jsxs)("div",{className:"text-center py-4",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]}):s?e?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[(0,n.jsxs)("p",{className:"text-blue-800 font-medium",children:["Welcome, ",s.displayName,"!"]}),(0,n.jsx)("p",{className:"text-blue-600 text-sm",children:s.email})]}),(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Players"}),(0,n.jsx)("div",{className:"space-y-2",children:Object.entries(e.players).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,n.jsxs)("span",{children:[t,": ",(null==r?void 0:r.name)||"Empty"]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:(null==r?void 0:r.type)==="bot"?"Bot":"Human"})]},t)})})]}):(0,n.jsxs)("div",{className:"text-center py-4",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Setting up your game..."})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Sign in with your Google account to start playing Rook13"}),(0,n.jsxs)("button",{onClick:d,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"})}),"Sign in with Google"]})]})]})})}},1688:function(e,t,r){r.d(t,{V:function(){return m},AuthProvider:function(){return h}});var l=r(7437),n=r(2265),a=r(5186),s=r(5236),i=r(9842),d=r(9854),o=r(7175);let c=(0,s.ZF)({apiKey:"AIzaSyCQOm9D3zWMTsi8GPsoSng3sxTUc2tEAUM",authDomain:"rook13-01.firebaseapp.com",projectId:"rook13-01",storageBucket:"rook13-01.firebasestorage.app",messagingSenderId:"325993848338",appId:"1:325993848338:web:adec6fc444c99aa72802cb",measurementId:"G-NWD5T9KRPM"}),u=(0,a.v0)(c);(0,i.ad)(c),(0,d.cF)(c),(0,o.IH)(c);let m=(0,n.createContext)({user:null,loading:!0,signInWithGoogle:async()=>{},signOut:async()=>{}});function h(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[i,d]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=u.onAuthStateChanged(e=>{s(e),d(!1)});return()=>e()},[]);let o=async()=>{let e=new a.hJ;try{await (0,a.rh)(u,e)}catch(e){console.error("Error signing in with Google",e)}},c=async()=>{try{await (0,a.w7)(u)}catch(e){console.error("Error signing out",e)}};return(0,l.jsx)(m.Provider,{value:{user:r,loading:i,signInWithGoogle:o,signOut:c},children:t})}},666:function(e,t,r){r.d(t,{a:function(){return a}});var l=r(2265),n=r(1688);let a=()=>(0,l.useContext)(n.V)}}]);